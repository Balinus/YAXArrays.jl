
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Yet Another XArray-like Julia Package">
      
      
        <meta name="author" content="Lazaro Alonso">
      
      
      
        <link rel="prev" href="../examples_from_esdl_study_1/">
      
      
        <link rel="next" href="../examples_from_esdl_study_3/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.17">
    
    
      
        <title>Examples from ESDL study 2 - YAXArrays</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lato";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/custom.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#examples-from-the-esdl-paper-mahecha-gans-et-al-earth-syst-dynam-11-201234-2020" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="YAXArrays" class="md-header__button md-logo" aria-label="YAXArrays" data-md-component="logo">
      
  <img src="../../../../assets/view-grid-plus-outline.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            YAXArrays
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Examples from ESDL study 2
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/JuliaDataCubes/YAXArrays.jl" title="" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    YAXArrays
  </div>
</a>


      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="YAXArrays" class="md-nav__button md-logo" aria-label="YAXArrays" data-md-component="logo">
      
  <img src="../../../../assets/view-grid-plus-outline.svg" alt="logo">

    </a>
    YAXArrays
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/JuliaDataCubes/YAXArrays.jl" title="" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    YAXArrays
  </div>
</a>


    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../creating/" class="md-nav__link">
        Creating YAXArrays and Datasets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../saving/" class="md-nav__link">
        Saving YAXArrays and Datasets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../setchuncks/" class="md-nav__link">
        Setting chunks's size
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../applyfunctions/" class="md-nav__link">
        Apply functions on YAXArrays
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../create_from_func/" class="md-nav__link">
        Generate a cube from function
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../openNetCDF/" class="md-nav__link">
        Open NetCDF
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../openZarr/" class="md-nav__link">
        Open Zarr (Store)
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../distributed/" class="md-nav__link">
        Distributed processes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../Gallery/simplemaps/" class="md-nav__link">
        Simple maps
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../tutorials/tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../HowdoI/howdoi/" class="md-nav__link">
        How do I ...
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../examples_from_esdl_study_1/" class="md-nav__link">
        Examples from ESDL study 1
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Examples from ESDL study 2
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Examples from ESDL study 2
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#case-study-2-intrinsic-dimensions-of-ecosystem-dynamics" class="md-nav__link">
    Case study 2: Intrinsic dimensions of ecosystem dynamics
  </a>
  
    <nav class="md-nav" aria-label="Case study 2: Intrinsic dimensions of ecosystem dynamics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-estimate-based-on-pcas" class="md-nav__link">
    As estimate based on PCAs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-steps-in-workflows-are-introduced-with-bold-headers" class="md-nav__link">
    New steps in workflows are introduced with bold headers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-and-prepare-subsetgapfill-an-earth-system-data-cube" class="md-nav__link">
    Select and prepare (subset/gapfill) an Earth system data cube.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimate-intrinsic-dimension-via-pca" class="md-nav__link">
    Estimate intrinsic dimension via PCA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-results-is-not-part-of-the-earthdatalab-package" class="md-nav__link">
    Visualizing results is not part of the EarthDataLab package.
  </a>
  
    <nav class="md-nav" aria-label="Visualizing results is not part of the EarthDataLab package.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-the-instrinsic-dimensions-maps" class="md-nav__link">
    Plotting the instrinsic dimensions maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotting-the-intrinsic-dimensions-histograms" class="md-nav__link">
    Plotting the intrinsic dimensions histograms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../examples_from_esdl_study_3/" class="md-nav__link">
        Examples from ESDL study 3
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contribute/contribute/" class="md-nav__link">
        Contribute to docs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../api/" class="md-nav__link">
        API
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#case-study-2-intrinsic-dimensions-of-ecosystem-dynamics" class="md-nav__link">
    Case study 2: Intrinsic dimensions of ecosystem dynamics
  </a>
  
    <nav class="md-nav" aria-label="Case study 2: Intrinsic dimensions of ecosystem dynamics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#as-estimate-based-on-pcas" class="md-nav__link">
    As estimate based on PCAs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#new-steps-in-workflows-are-introduced-with-bold-headers" class="md-nav__link">
    New steps in workflows are introduced with bold headers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#select-and-prepare-subsetgapfill-an-earth-system-data-cube" class="md-nav__link">
    Select and prepare (subset/gapfill) an Earth system data cube.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimate-intrinsic-dimension-via-pca" class="md-nav__link">
    Estimate intrinsic dimension via PCA
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualizing-results-is-not-part-of-the-earthdatalab-package" class="md-nav__link">
    Visualizing results is not part of the EarthDataLab package.
  </a>
  
    <nav class="md-nav" aria-label="Visualizing results is not part of the EarthDataLab package.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plotting-the-instrinsic-dimensions-maps" class="md-nav__link">
    Plotting the instrinsic dimensions maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plotting-the-intrinsic-dimensions-histograms" class="md-nav__link">
    Plotting the intrinsic dimensions histograms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><p><a id="Examples-from-the-ESDL-paper-(Mahecha,-Gans-et-al.-Earth-Syst.-Dynam.,-11,-201–234,-2020)"></a></p>
<p><a id="Examples-from-the-ESDL-paper-(Mahecha,-Gans-et-al.-Earth-Syst.-Dynam.,-11,-201–234,-2020)-1"></a></p>
<h1 id="examples-from-the-esdl-paper-mahecha-gans-et-al-earth-syst-dynam-11-201234-2020">Examples from the ESDL paper (Mahecha, Gans et al. Earth Syst. Dynam., 11, 201–234, 2020)<a class="headerlink" href="#examples-from-the-esdl-paper-mahecha-gans-et-al-earth-syst-dynam-11-201234-2020" title="Permanent link">¤</a></h1>
<p><strong>NOTE:</strong> This section is based on the case studies from the paper "Earth system data cubes unravel global multivariate dynamics" by Mahecha, Gans et al. (2019), available <a href="https://github.com/esa-esdl/ESDLPaperCode.jl">here</a>.</p>
<ul>
<li>We have slightly adjusted the scripts. A few differences are that these new scripts are updated to Julia 1.9, and the YAXArrays.jl package is used.</li>
<li>The dataset has been updated but it has less available variables. Therefore the results might differ.</li>
<li>The calculations are performed with a very coarse spatial (2.5°) and temporal resolution (monthly).</li>
<li>These are examples for illustrative purposes of the packages and do not intend any deeper scientific interpretation. For scientific analysis use the higher spatio-temporal resolution datasets.</li>
</ul>
<p><a id="Case-study-2:-Intrinsic-dimensions-of-ecosystem-dynamics"></a></p>
<p><a id="Case-study-2:-Intrinsic-dimensions-of-ecosystem-dynamics-1"></a></p>
<h2 id="case-study-2-intrinsic-dimensions-of-ecosystem-dynamics">Case study 2: Intrinsic dimensions of ecosystem dynamics<a class="headerlink" href="#case-study-2-intrinsic-dimensions-of-ecosystem-dynamics" title="Permanent link">¤</a></h2>
<p><a id="As-estimate-based-on-PCAs"></a></p>
<p><a id="As-estimate-based-on-PCAs-1"></a></p>
<h3 id="as-estimate-based-on-pcas">As estimate based on PCAs<a class="headerlink" href="#as-estimate-based-on-pcas" title="Permanent link">¤</a></h3>
<ul>
<li>Script to reproduce and understand examples in the paper <em>Earth system data cubes unravel global multivariate dynamics</em> .</li>
<li>The code is written on Julia 1.9</li>
<li>Normal text are explanations referring to notation and equations in the paper</li>
<li><code># comments in the code are intended to explain specific aspects of the coding</code></li>
<li>
<h3 id="new-steps-in-workflows-are-introduced-with-bold-headers">New steps in workflows are introduced with <strong>bold headers</strong><a class="headerlink" href="#new-steps-in-workflows-are-introduced-with-bold-headers" title="Permanent link">¤</a></h3>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c"># Load requiered packages</span>
<span class="k">using</span><span class="w"> </span><span class="n">Pkg</span>

<span class="c"># for operating data cubes</span>
<span class="k">using</span><span class="w"> </span><span class="n">Zarr</span><span class="p">,</span><span class="w"> </span><span class="n">YAXArrays</span>

<span class="c"># for operating the Earth system data lab</span>
<span class="k">using</span><span class="w"> </span><span class="n">EarthDataLab</span>

<span class="c"># for data analysis</span>
<span class="k">using</span><span class="w"> </span><span class="n">Statistics</span><span class="p">,</span><span class="w"> </span><span class="n">MultivariateStats</span><span class="p">,</span><span class="w"> </span><span class="n">Dates</span><span class="p">,</span><span class="w"> </span><span class="n">SkipNan</span>

<span class="c"># for plotting later</span>
<span class="k">using</span><span class="w"> </span><span class="n">CairoMakie</span>
<span class="n">CairoMakie</span><span class="o">.</span><span class="n">activate!</span><span class="p">()</span>
<span class="k">using</span><span class="w"> </span><span class="n">GeoMakie</span>
</code></pre></div>
<p>In this study we investigate the redundancy of the different variables in each pixel. Therefore we calculate a linear dimensionality reduction (PCA) and check how many dimensions are needed to explain 90% of the variance of a cube that contained originally 11 variables.</p>
<p><a id="Select-and-prepare-(subset/gapfill)-an-Earth-system-data-cube."></a></p>
<p><a id="Select-and-prepare-(subset/gapfill)-an-Earth-system-data-cube.-1"></a></p>
<h3 id="select-and-prepare-subsetgapfill-an-earth-system-data-cube">Select and prepare (subset/gapfill) an Earth system data cube.<a class="headerlink" href="#select-and-prepare-subsetgapfill-an-earth-system-data-cube" title="Permanent link">¤</a></h3>
<p>We need to choose a cube and here select a monthly, 2.5° resolution global cube. This very low resolution cube aims at rapid processing for the safe of time and computational resources.</p>
<div class="highlight"><pre><span></span><code><span class="n">cube_handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">esdc</span><span class="p">(</span><span class="n">res</span><span class="o">=</span><span class="s">"tiny"</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>YAXArray with the following dimensions
lon                 Axis with 144 Elements from -178.75 to 178.75
lat                 Axis with 72 Elements from -88.75 to 88.75
time                Axis with 989 Elements from 1979-01-09T00:00:00 to 2021-12-27T00:00:00
Variable            Axis with 42 elements: sensible_heat potential_evaporation .. net_ecosystem_exchange snow_sublimation 
units: mm d^-1
Total size: 1.6 GB
</code></pre></div>
<p>Check which variables are avaiable in the data cube:</p>
<div class="highlight"><pre><span></span><code><span class="c"># if we want the names of the variables:</span>
<span class="n">println</span><span class="p">(</span><span class="n">getAxis</span><span class="p">(</span><span class="s">"Var"</span><span class="p">,</span><span class="w"> </span><span class="n">cube_handle</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>["sensible_heat", "potential_evaporation", "evaporation", "root_moisture", "radiation_era5", "sif_rtsif", "open_water_evaporation", "nbar_swir1", "latent_energy", "max_air_temperature_2m", "nbar_blue", "cth", "nirv", "aerosol_optical_thickness_550", "ctt", "air_temperature_2m", "nbar_swir3", "nbar_red", "evaporative_stress", "precipitation_era5", "nbar_green", "terrestrial_ecosystem_respiration", "gross_primary_productivity", "ndvi", "bare_soil_evaporation", "nbar_swir2", "sif_gosif", "sif_gome2_jj", "net_radiation", "cot", "kndvi", "sif_gome2_pk", "evaporation_era5", "transpiration", "surface_moisture", "nbar_nir", "interception_loss", "min_air_temperature_2m", "sm", "burnt_area", "net_ecosystem_exchange", "snow_sublimation"]
</code></pre></div>
<p>Having the variable names allows us to make a selection, such that we can subset the global cube. We should also take care that the variables are as complete as possible in the time window we analyze. This has been explored a priori.</p>
<div class="highlight"><pre><span></span><code><span class="c"># vector of variables we will work with</span>
<span class="n">vars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">"evaporative_stress"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"latent_energy"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"root_moisture"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"transpiration"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"sensible_heat"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"bare_soil_evaporation"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"net_radiation"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"net_ecosystem_exchange"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"evaporation"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"terrestrial_ecosystem_respiration"</span><span class="p">,</span>
<span class="w">    </span><span class="s">"gross_primary_productivity"</span><span class="p">,</span>
<span class="w">    </span><span class="p">];</span>

<span class="c"># time window where most of them are complete</span>
<span class="n">timespan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Date</span><span class="p">(</span><span class="s">"2003-01-01"</span><span class="p">)</span><span class="o">..</span><span class="n">Date</span><span class="p">(</span><span class="s">"2011-12-31"</span><span class="p">)</span>

<span class="c"># subset the grand cube and get the cube we will analyse here</span>
<span class="n">cube_subset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subsetcube</span><span class="p">(</span><span class="n">cube_handle</span><span class="p">,</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">timespan</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vars</span><span class="p">)</span>

<span class="n">println</span><span class="p">(</span><span class="n">getAxis</span><span class="p">(</span><span class="s">"Var"</span><span class="p">,</span><span class="w"> </span><span class="n">cube_subset</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>["evaporative_stress", "latent_energy", "root_moisture", "transpiration", "sensible_heat", "bare_soil_evaporation", "net_radiation", "net_ecosystem_exchange", "evaporation", "terrestrial_ecosystem_respiration", "gross_primary_productivity"]
</code></pre></div>
<p>An important preprocessing step is gapfilling. We do not want to enter the debate on the optimal gapfilling method. What we do here is gapfilling first with the mean seasonal cycle (where it can be estimated), and interpolating long-recurrent gaps (typically in winter seasons). use the EarthDataLab buit-in function</p>
<div class="highlight"><pre><span></span><code><span class="nd">@time</span><span class="w"> </span><span class="n">cube_fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gapFillMSC</span><span class="p">(</span><span class="n">cube_subset</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>YAXArray with the following dimensions
time                Axis with 207 Elements from 2003-01-09T00:00:00 to 2011-12-27T00:00:00
lon                 Axis with 144 Elements from -178.75 to 178.75
lat                 Axis with 72 Elements from -88.75 to 88.75
Variable            Axis with 11 elements: evaporative_stress latent_energy .. terrestrial_ecosystem_respiration gross_primary_productivity 
Total size: 90.06 MB
</code></pre></div>
<p>The interpolation of wintergaps needs a function that we code here an call <code>LinInterp</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">using</span><span class="w"> </span><span class="n">Interpolations</span>

<span class="k">function</span><span class="w"> </span><span class="n">LinInterp</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="w">  </span><span class="k">try</span>
<span class="w">    </span><span class="c"># find the values we need to input</span>
<span class="w">    </span><span class="n">idx_nan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findall</span><span class="p">(</span><span class="n">ismissing</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">    </span><span class="n">idx_ok</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">findall</span><span class="p">(</span><span class="o">!</span><span class="n">ismissing</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>

<span class="w">    </span><span class="c"># make sure to have a homogenous input array</span>
<span class="w">    </span><span class="n">y2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Float64</span><span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">idx_ok</span><span class="p">]</span>

<span class="w">    </span><span class="c"># generate an interpolation object based on the good data</span>
<span class="w">    </span><span class="n">itp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extrapolate</span><span class="p">(</span><span class="n">interpolate</span><span class="p">((</span><span class="n">idx_ok</span><span class="p">,),</span><span class="w"> </span><span class="n">y2</span><span class="p">,</span><span class="w"> </span><span class="n">Gridded</span><span class="p">(</span><span class="n">Linear</span><span class="p">())),</span><span class="n">Flat</span><span class="p">())</span>

<span class="w">    </span><span class="c"># fill the missing values based on a linter interpolation</span>
<span class="w">    </span><span class="n">y</span><span class="p">[</span><span class="n">idx_nan</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itp</span><span class="p">(</span><span class="n">idx_nan</span><span class="p">)</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">y</span>
<span class="w">  </span><span class="k">catch</span>
<span class="w">    </span><span class="n">idx_nan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findall</span><span class="p">(</span><span class="n">ismissing</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="w">    </span><span class="n">y</span><span class="p">[</span><span class="n">idx_nan</span><span class="p">]</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">skipmissing</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">y</span>
<span class="w">  </span><span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>LinInterp (generic function with 1 method)
</code></pre></div>
<p>The function <code>LiInterp</code> can now be applied on each time series, so we would have a rather trival mapping of the form:</p>
<div class="arithmatex">\[\begin{equation}   f_{{time}}^{{time}} : \mathcal{C}({lat, lon, time, var}) \rightarrow \mathcal{C}({lat, lon, time, var}). \end{equation}\]</div>
<p>For operations of this kind, the best is to use the <code>mapslices</code> function. In the EarthDataLab package, this function needs the input function, the cube handle, and an indication on which dimension we would apply it. The function can then infer that the output dimension here is also an axis of type <code>Time</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">cube_fill_itp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapslices</span><span class="p">(</span><span class="n">LinInterp</span><span class="p">,</span><span class="w"> </span><span class="n">cube_fill</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Time"</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>YAXArray with the following dimensions
time                Axis with 207 Elements from 2003-01-09T00:00:00 to 2011-12-27T00:00:00
lon                 Axis with 144 Elements from -178.75 to 178.75
lat                 Axis with 72 Elements from -88.75 to 88.75
Variable            Axis with 11 elements: evaporative_stress latent_energy .. terrestrial_ecosystem_respiration gross_primary_productivity 
Total size: 90.06 MB
</code></pre></div>
<p>As we describe in the paper, we estimate the intrinsic dimensions from the raw, yet gapfilled, data cube (<code>cube_fill_itp</code>), but also based on spectrally decomposed data. The decomposition via discrete FFTs is an atomic operation of the following form (Eq. 12),</p>
<div class="arithmatex">\[\begin{equation}   f_{{time}}^{{time, freq}} : \mathcal{C}({lat, lon, time, var}) \rightarrow \mathcal{C}({lat, lon, time, var, freq}). \end{equation}\]</div>
<p>which can be done using a pre-implemented EarthDataLab function. Note that this step will use a lot of computing time.</p>
<div class="highlight"><pre><span></span><code><span class="n">cube_decomp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filterTSFFT</span><span class="p">(</span><span class="n">cube_fill_itp</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>YAXArray with the following dimensions
time                Axis with 207 Elements from 2003-01-09T00:00:00 to 2011-12-27T00:00:00
Scale               Axis with 4 elements: Trend Long-Term Variability Annual Cycle Fast Oscillations 
lon                 Axis with 144 Elements from -178.75 to 178.75
lat                 Axis with 72 Elements from -88.75 to 88.75
Variable            Axis with 11 elements: evaporative_stress latent_energy .. terrestrial_ecosystem_respiration gross_primary_productivity 
Total size: 360.23 MB
</code></pre></div>
<p><a id="Estimate-intrinsic-dimension-via-PCA"></a></p>
<p><a id="Estimate-intrinsic-dimension-via-PCA-1"></a></p>
<h3 id="estimate-intrinsic-dimension-via-pca">Estimate intrinsic dimension via PCA<a class="headerlink" href="#estimate-intrinsic-dimension-via-pca" title="Permanent link">¤</a></h3>
<p>For estimating the intrinsic estimation via PCA from a multivariate time series we need essentially two atomic functions. First, dimensionality reduction,</p>
<div class="arithmatex">\[\begin{equation}      f_{{time, var}}^{{time, princomp }} : \mathcal{C}({time, var}) \rightarrow \mathcal{C}({time, princomp}) \end{equation}\]</div>
<p>And second estimating from the reduced space the number of dimensions that represent more variance than the threshold (for details see paper): \begin{equation}      f_{{time, princomp}}^{{ }} : \mathcal{C}({time, var}) \rightarrow \mathcal{C}({int dim}) \end{equation}</p>
<p>However, we as both steps emerge from the same analysis it is more efficient to wrap these two steps in a single atomic functions which has the structure: \begin{equation}      f_{{time, var}}^{{ }} : \mathcal{C}({time, var}) \rightarrow \mathcal{C}({}) \end{equation}</p>
<p>We can now apply this to the cube: The latter was the operation described in the paper (Eq. 11) as</p>
<div class="arithmatex">\[\begin{equation}      f_{{time, var}}^{{ }} : \mathcal{C}({lat, lon, time, var}) \rightarrow \mathcal{C}({lat, lon}) \end{equation}\]</div>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="n">sufficient_dimensions</span><span class="p">(</span><span class="n">xin</span><span class="o">::</span><span class="kt">AbstractArray</span><span class="p">,</span><span class="w"> </span><span class="n">expl_var</span><span class="o">::</span><span class="kt">Float64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.95</span><span class="p">)</span>

<span class="w">  </span><span class="n">any</span><span class="p">(</span><span class="n">ismissing</span><span class="p">,</span><span class="n">xin</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nb">NaN</span>
<span class="w">  </span><span class="n">npoint</span><span class="p">,</span><span class="w"> </span><span class="n">nvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">xin</span><span class="p">)</span>
<span class="w">  </span><span class="n">means</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="n">stds</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span><span class="w">  </span><span class="n">dims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">  </span><span class="n">xin</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">broadcast</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">s</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">one</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="w"> </span><span class="n">xin</span><span class="p">,</span><span class="w"> </span><span class="n">means</span><span class="p">,</span><span class="w"> </span><span class="n">stds</span><span class="p">)</span>
<span class="w">  </span><span class="n">pca</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fit</span><span class="p">(</span><span class="n">PCA</span><span class="p">,</span><span class="w"> </span><span class="n">xin</span><span class="o">'</span><span class="p">,</span><span class="w"> </span><span class="n">pratio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.999</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">:svd</span><span class="p">)</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">findfirst</span><span class="p">(</span><span class="n">cumsum</span><span class="p">(</span><span class="n">principalvars</span><span class="p">(</span><span class="n">pca</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">tprincipalvar</span><span class="p">(</span><span class="n">pca</span><span class="p">)</span><span class="w"> </span><span class="o">.&gt;</span><span class="w"> </span><span class="n">expl_var</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>sufficient_dimensions (generic function with 2 methods)
</code></pre></div>
<p>We first apply the function <code>cube_decomp</code> to the standard data cube with the threshold of 95% of retained variance. As we see from the description of the atomic function above, we need as minimum input dimension <code>Time</code> and <code>Variable</code>. We call the output cube <code>cube_int_dim</code>, which efficiently is a map.</p>
<div class="highlight"><pre><span></span><code><span class="n">cube_int_dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapslices</span><span class="p">(</span><span class="n">sufficient_dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">cube_fill_itp</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s">"Time"</span><span class="p">,</span><span class="s">"Variable"</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>YAXArray with the following dimensions
lon                 Axis with 144 Elements from -178.75 to 178.75
lat                 Axis with 72 Elements from -88.75 to 88.75
Total size: 40.5 KB
</code></pre></div>
<p>Saving intermediate results can save CPU later, not needed to guarantee reproducibility tough <code>savecube(cube_int_dim, "../data/IntDim", overwrite=true)</code></p>
<p>Now we apply the same function</p>
<div class="arithmatex">\[\begin{equation}       f_{{time, var}}^{{ }} : \mathcal{C}({time, var}) \rightarrow \mathcal{C}({})   \end{equation}\]</div>
<p>to the spectrally decomposed cube (Eq. 13):</p>
<div class="arithmatex">\[\begin{equation}          f_{{time, var}}^{{}} : \mathcal{C}({lat, lon, time, var, freq})\rightarrow \mathcal{C}({lat, lon, freq})   \end{equation}\]</div>
<div class="highlight"><pre><span></span><code><span class="n">cube_int_dim_dec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapslices</span><span class="p">(</span><span class="n">sufficient_dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">cube_decomp</span><span class="p">,</span><span class="w"> </span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s">"Time"</span><span class="p">,</span><span class="s">"Variable"</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>YAXArray with the following dimensions
Scale               Axis with 4 elements: Trend Long-Term Variability Annual Cycle Fast Oscillations 
lon                 Axis with 144 Elements from -178.75 to 178.75
lat                 Axis with 72 Elements from -88.75 to 88.75
Total size: 162.0 KB
</code></pre></div>
<p>for saving the output please use the command line below <code>savecube(cube_int_dim_dec, "../data/IntDimDec", overwrite=true)</code></p>
<p><a id="Visualizing-results-is-not-part-of-the-EarthDataLab-package."></a></p>
<p><a id="Visualizing-results-is-not-part-of-the-EarthDataLab-package.-1"></a></p>
<h3 id="visualizing-results-is-not-part-of-the-earthdatalab-package">Visualizing results is not part of the EarthDataLab package.<a class="headerlink" href="#visualizing-results-is-not-part-of-the-earthdatalab-package" title="Permanent link">¤</a></h3>
<p>Here we use GeoMalkie for plotting in comparison to the original script that relies on PyPlot.</p>
<p><a id="Plotting-the-instrinsic-dimensions-maps"></a></p>
<p><a id="Plotting-the-instrinsic-dimensions-maps-1"></a></p>
<h4 id="plotting-the-instrinsic-dimensions-maps">Plotting the instrinsic dimensions maps<a class="headerlink" href="#plotting-the-instrinsic-dimensions-maps" title="Permanent link">¤</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># standard function for plotting global grids</span>
<span class="k">function</span><span class="w"> </span><span class="n">geoplotsfx</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span><span class="w"> </span><span class="n">titlein</span><span class="p">,</span><span class="w"> </span><span class="n">labelin</span><span class="p">,</span><span class="w"> </span><span class="n">crange</span><span class="p">,</span><span class="w"> </span><span class="n">cmap</span><span class="p">)</span>
<span class="w">  </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoMakie</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
<span class="w">  </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoAxis</span><span class="p">(</span><span class="n">fig</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">coastlines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">  </span><span class="n">lonlims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">),</span><span class="w"> </span><span class="n">latlims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="n">sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoMakie</span><span class="o">.</span><span class="n">surface!</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">90</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="n">xin</span><span class="p">;</span><span class="w"> </span><span class="n">shading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">  </span><span class="n">colormap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,),</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="w">  </span><span class="n">cb1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colorbar</span><span class="p">(</span><span class="n">fig</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">sf</span><span class="p">;</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">labelin</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Relative</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">vertical</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">highclip</span><span class="o">=</span><span class="kt">RGBA</span><span class="p">{</span><span class="kt">Float32</span><span class="p">}(</span><span class="mf">0.059f0</span><span class="p">,</span><span class="mf">0.084f0</span><span class="p">,</span><span class="mf">0.072f0</span><span class="p">,</span><span class="mf">1f0</span><span class="p">))</span>
<span class="w">  </span><span class="n">Label</span><span class="p">(</span><span class="n">fig</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">titlein</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Relative</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
<span class="w">  </span><span class="k">return</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">labelin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Intrinsic dimension"</span>

<span class="n">crange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>

<span class="n">cmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reverse</span><span class="p">(</span><span class="ss">:magma</span><span class="p">)</span>

<span class="n">scale_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">"(a) Original Data"</span><span class="p">,</span><span class="w"> </span><span class="s">"(b) Long-term variability"</span><span class="p">,</span><span class="w"> </span><span class="s">"(c) Seasonal variability"</span><span class="p">,</span><span class="w"> </span><span class="s">"(d) Short-term variability"</span><span class="p">]</span>

<span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CairoMakie</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">resolution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="mi">700</span><span class="p">))</span>
<span class="n">titlein</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">string</span><span class="p">(</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c"># map original data</span>
<span class="w">  </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoAxis</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">coastlines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">lonlims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">),</span><span class="w"> </span><span class="n">latlims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="w">  </span><span class="n">sf1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoMakie</span><span class="o">.</span><span class="n">surface!</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">90</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="n">cube_int_dim</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">];</span><span class="w"> </span><span class="n">shading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">  </span><span class="n">colormap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,),</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="w">  </span><span class="n">cb1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Colorbar</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">sf1</span><span class="p">;</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="n">labelin</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Relative</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">vertical</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">highclip</span><span class="o">=</span><span class="kt">RGBA</span><span class="p">{</span><span class="kt">Float32</span><span class="p">}(</span><span class="mf">0.059f0</span><span class="p">,</span><span class="mf">0.084f0</span><span class="p">,</span><span class="mf">0.072f0</span><span class="p">,</span><span class="mf">1f0</span><span class="p">))</span>
<span class="c"># map Long-term variability</span>
<span class="w">  </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoAxis</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="n">coastlines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">lonlims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">),</span><span class="w"> </span><span class="n">latlims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="w">  </span><span class="n">GeoMakie</span><span class="o">.</span><span class="n">surface!</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">90</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="n">cube_int_dim_dec</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">];</span><span class="w"> </span><span class="n">shading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">  </span><span class="n">colormap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,),</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="c"># map seasonal variability</span>
<span class="w">  </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoAxis</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">coastlines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">lonlims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">),</span><span class="w"> </span><span class="n">latlims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="w">  </span><span class="n">GeoMakie</span><span class="o">.</span><span class="n">surface!</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">90</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="n">cube_int_dim_dec</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">];</span><span class="w"> </span><span class="n">shading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">  </span><span class="n">colormap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,),</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="c"># map seasonal variability</span>
<span class="w">  </span><span class="n">ax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GeoAxis</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="n">coastlines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">lonlims</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="mi">180</span><span class="p">),</span><span class="w"> </span><span class="n">latlims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">),</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="w">  </span><span class="n">GeoMakie</span><span class="o">.</span><span class="n">surface!</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">180</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">90</span><span class="o">:</span><span class="mf">2.5</span><span class="o">:</span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="n">cube_int_dim_dec</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">];</span><span class="w"> </span><span class="n">shading</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">  </span><span class="n">colormap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,),</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">,</span><span class="w"> </span><span class="n">rev</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
<span class="n">f</span>
</code></pre></div>
<p><img alt="" src="../qhsbblk.png"></p>
<p><a id="Plotting-the-intrinsic-dimensions-histograms"></a></p>
<p><a id="Plotting-the-intrinsic-dimensions-histograms-1"></a></p>
<h4 id="plotting-the-intrinsic-dimensions-histograms">Plotting the intrinsic dimensions histograms<a class="headerlink" href="#plotting-the-intrinsic-dimensions-histograms" title="Permanent link">¤</a></h4>
<p>we will weight out reslults considering the pixel size. For this we use the cosine of the latitudes.</p>
<div class="highlight"><pre><span></span><code><span class="n">lat_ax_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAxis</span><span class="p">(</span><span class="s">"lat"</span><span class="p">,</span><span class="w"> </span><span class="n">cube_int_dim_dec</span><span class="p">)</span>
<span class="n">lon_ax_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAxis</span><span class="p">(</span><span class="s">"lon"</span><span class="p">,</span><span class="w"> </span><span class="n">cube_int_dim_dec</span><span class="p">)</span>
<span class="n">weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reshape</span><span class="p">(</span><span class="n">cosd</span><span class="o">.</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="n">lat_ax_vals</span><span class="p">,</span><span class="w"> </span><span class="n">inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">lon_ax_vals</span><span class="p">))),</span><span class="w"> </span><span class="mi">144</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>

<span class="c"># identify pixels with values and exclude missings</span>
<span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findall</span><span class="p">(</span><span class="n">i</span><span class="o">-&gt;</span><span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">skipmissing</span><span class="p">(</span><span class="n">cube_int_dim</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">]))</span>
<span class="n">weights_sub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weights</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">weights_sum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">weights_sub</span><span class="p">)</span>

<span class="c"># function for calculation weighted frequencies of intrinsic dimensions</span>
<span class="k">function</span><span class="w"> </span><span class="n">weightdatafrec</span><span class="p">(</span><span class="n">xin</span><span class="p">,</span><span class="w"> </span><span class="n">weights_sub</span><span class="p">,</span><span class="w"> </span><span class="n">weights_sum</span><span class="p">)</span>
<span class="w">  </span><span class="n">dout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">Array</span><span class="p">{</span><span class="kt">Union</span><span class="p">{</span><span class="kt">Missing</span><span class="p">,</span><span class="w"> </span><span class="kt">Float32</span><span class="p">}}(</span><span class="nb">missing</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">  </span><span class="n">dout</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">.=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">11</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="n">size</span><span class="p">(</span><span class="n">dout</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="w">  </span><span class="n">idx2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">findall</span><span class="p">(</span><span class="n">x</span><span class="o">-&gt;</span><span class="n">x</span><span class="o">==</span><span class="n">dout</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">xin</span><span class="p">)</span>
<span class="w">  </span><span class="n">dout</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="n">weights_sub</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span><span class="o">/</span><span class="n">weights_sum</span>
<span class="w">  </span><span class="k">end</span>
<span class="w">  </span><span class="n">dout</span>
<span class="k">end</span>

<span class="n">d1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weightdatafrec</span><span class="p">(</span><span class="n">skipmissing</span><span class="p">(</span><span class="n">cube_int_dim</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">])[</span><span class="n">idx</span><span class="p">],</span><span class="w"> </span><span class="n">weights_sub</span><span class="p">,</span><span class="w"> </span><span class="n">weights_sum</span><span class="p">)</span>
<span class="n">d2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weightdatafrec</span><span class="p">(</span><span class="n">skipmissing</span><span class="p">(</span><span class="n">cube_int_dim_dec</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">])[</span><span class="n">idx</span><span class="p">],</span><span class="w"> </span><span class="n">weights_sub</span><span class="p">,</span><span class="w"> </span><span class="n">weights_sum</span><span class="p">)</span>
<span class="n">d3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weightdatafrec</span><span class="p">(</span><span class="n">skipmissing</span><span class="p">(</span><span class="n">cube_int_dim_dec</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">])[</span><span class="n">idx</span><span class="p">],</span><span class="w"> </span><span class="n">weights_sub</span><span class="p">,</span><span class="w"> </span><span class="n">weights_sum</span><span class="p">)</span>
<span class="n">d4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">weightdatafrec</span><span class="p">(</span><span class="n">skipmissing</span><span class="p">(</span><span class="n">cube_int_dim_dec</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="o">:</span><span class="p">,</span><span class="o">:</span><span class="p">])[</span><span class="n">idx</span><span class="p">],</span><span class="w"> </span><span class="n">weights_sub</span><span class="p">,</span><span class="w"> </span><span class="n">weights_sum</span><span class="p">)</span>

<span class="c"># plot histograms</span>
<span class="n">f2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CairoMakie</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Axis</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">ylabel</span><span class="o">=</span><span class="s">"Weighted frequency"</span><span class="p">,</span><span class="w"> </span><span class="n">xticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">yticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.2</span><span class="o">:</span><span class="mf">0.6</span><span class="p">;</span><span class="w"> </span><span class="n">limits</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Axis</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">xticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">yticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.2</span><span class="o">:</span><span class="mf">0.6</span><span class="p">;</span><span class="w"> </span><span class="n">limits</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Axis</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">xticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">yticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.2</span><span class="o">:</span><span class="mf">0.6</span><span class="p">;</span><span class="w"> </span><span class="n">limits</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">ax4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Axis</span><span class="p">(</span><span class="n">f2</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">xlabel</span><span class="o">=</span><span class="s">"Intrinsic dimensions"</span><span class="p">,</span><span class="w"> </span><span class="n">xticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">yticks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="mf">0.2</span><span class="o">:</span><span class="mf">0.6</span><span class="p">;</span><span class="w"> </span><span class="n">limits</span><span class="p">,</span><span class="w"> </span><span class="n">title</span><span class="o">=</span><span class="n">scale_name</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="c"># (a) Original data</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">:</span><span class="mi">11</span>
<span class="n">barplot!</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">d1</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">colormap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">)</span><span class="c">#, weights=weights_idx)</span>
<span class="c"># (b) Long-term variability</span>
<span class="n">barplot!</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">d2</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">colormap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">)</span>
<span class="c"># (c) Seasonal variability</span>
<span class="n">barplot!</span><span class="p">(</span><span class="n">ax3</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">d3</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">colormap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">)</span>
<span class="c"># (d) Short-term variability</span>
<span class="n">barplot!</span><span class="p">(</span><span class="n">ax4</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">d4</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">colormap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span><span class="w"> </span><span class="n">colorrange</span><span class="o">=</span><span class="n">crange</span><span class="p">)</span>
<span class="n">f2</span>
</code></pre></div>
<p><img alt="" src="../iseerwu.png"></p>
<hr>
<p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../examples_from_esdl_study_1/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Examples from ESDL study 1" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Examples from ESDL study 1
              </div>
            </div>
          </a>
        
        
          
          <a href="../examples_from_esdl_study_3/" class="md-footer__link md-footer__link--next" aria-label="Next: Examples from ESDL study 3" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Examples from ESDL study 3
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.top", "navigation.footer", "search.highlight", "search.share", "search.suggest", "toc.follow", "header.autohide"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.b425cdc4.min.js"></script>
      
        
          <script src="../../../../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>